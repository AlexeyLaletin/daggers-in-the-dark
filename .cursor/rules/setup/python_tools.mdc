---
description: Setup Python development tools (Ruff, Mypy, pre-commit)
alwaysApply: false
---
# Python Tools Setup Guide

**Purpose:** Setup and configuration for Python development tools (Ruff, Mypy, pre-commit).

**When to use:** When setting up a new Python project or configuring development tools.

**Related:**
- Commands: `.cursor/rules/reference/commands.mdc`
- Validation workflows: `.cursor/rules/setup/validation.mdc`
- Python rules: `.cursor/agents/python-developer/AGENTS.md`

## Overview

This guide covers setting up Python development tools (Ruff, Mypy, pre-commit) in a typical Git-based repository.

## Ruff Setup

### Installation

Install Ruff (recommended via `pipx`, or within your project’s virtualenv):

```bash
pipx install ruff
# or: pip install ruff
```

### Configuration

Create `.ruff.toml` in project root:

```toml
# .ruff.toml
line-length = 100
target-version = "py39"

[lint]
# Enable specific rule sets
select = [
    "E",   # pycodestyle errors
    "W",   # pycodestyle warnings
    "F",   # pyflakes
    "I",   # isort
    "B",   # flake8-bugbear
    "C4",  # flake8-comprehensions
    "UP",  # pyupgrade
]

# Ignore specific rules
ignore = [
    "E501",  # line too long (handled by formatter)
]

# Allow autofix for these rules
fixable = ["ALL"]
unfixable = []

[lint.per-file-ignores]
"__init__.py" = ["F401"]  # Allow unused imports in __init__.py
"tests/*" = ["E501"]      # Allow long lines in tests

[lint.isort]
known-first-party = ["your_module"]
```

### Usage

See `.cursor/rules/reference/commands.mdc` for all Ruff commands.

### Integration with CI

- Run `ruff check .` and `ruff format --check .` in CI.
- Optionally run `ruff check --fix .` locally (not in CI) to auto-fix issues.

## Mypy Setup

### Installation

Install Mypy:

```bash
pipx install mypy
# or: pip install mypy
```

### Configuration

Create `mypy.ini` in project root:

```ini
# mypy.ini
[mypy]
python_version = 3.9
warn_return_any = True
warn_unused_configs = True
disallow_untyped_defs = True
disallow_incomplete_defs = True
check_untyped_defs = True
disallow_untyped_decorators = True
no_implicit_optional = True
warn_redundant_casts = True
warn_unused_ignores = True
warn_no_return = True
warn_unreachable = True
strict_equality = True
show_error_codes = True

# Ignore missing imports for third-party libraries
[mypy-*.third_party.*]
ignore_missing_imports = True

# Project-specific overrides
[mypy-your_module.*]
disallow_untyped_defs = False  # If needed for legacy code
```

### Usage

See `.cursor/rules/reference/commands.mdc` for all Mypy commands.

### Integration with CI

- Run `mypy .` in CI using your repo’s config (e.g. `mypy.ini` or `pyproject.toml`).

## Pre-commit Setup

### Installation

Install pre-commit:

```bash
pip install pre-commit
```

### Configuration

Create `.pre-commit-config.yaml` in project root:

```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files
      - id: check-json
      - id: check-toml
      - id: check-merge-conflict
      - id: debug-statements

  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.1.0
    hooks:
      - id: ruff
        args: [--fix, --exit-non-zero-on-fix]
      - id: ruff-format

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.5.1
    hooks:
      - id: mypy
        additional_dependencies: [types-all]
        args: [--config-file=mypy.ini]
```

### Installation

```bash
# Install pre-commit hooks
pre-commit install

# Install hooks for commit-msg
pre-commit install --hook-type commit-msg

# Run on all files (first time)
pre-commit run --all-files

# Run on staged files (automatic on commit)
pre-commit run
```

### Usage

Pre-commit runs automatically on `git commit`. See `.cursor/rules/reference/commands.mdc` for manual commands.

## Complete Setup Example

### Project Structure
```
project/
├── src/
│   └── module/
│       ├── __init__.py
│       └── main.py
├── tests/
│   └── test_module.py
├── pyproject.toml
├── .ruff.toml
├── mypy.ini
├── .pre-commit-config.yaml
└── README.md
```

### Setup Script

Create `setup_dev.sh`:

```bash
#!/bin/bash
# Setup development environment

# Check tools
echo "Checking tools..."
which ruff || echo "Ruff not found"
which mypy || echo "Mypy not found"
which pre-commit || echo "Pre-commit not found"

# Install pre-commit hooks
if command -v pre-commit &> /dev/null; then
    echo "Installing pre-commit hooks..."
    pre-commit install
fi

# Run initial checks
echo "Running initial checks..."
ruff check . || echo "Ruff found issues"
mypy . || echo "Mypy found issues"

echo "Setup complete!"
```

## Best Practices

1. **Configure tools early** - Set up tools at project start
2. **Use consistent configs** - Share configs across projects
3. **Run checks before commit** - Use pre-commit hooks
4. **Fix issues promptly** - Don't accumulate technical debt
5. **Update tool versions** - Keep tools up-to-date
6. **Document exceptions** - Comment why rules are ignored

## Troubleshooting

### Ruff Issues
- Check `.ruff.toml` syntax
- Verify rule names are correct
- Check file paths in per-file-ignores

### Mypy Issues
- Check `mypy.ini` syntax
- Verify type stubs are available
- Use `# type: ignore` sparingly with comments

### Pre-commit Issues
- Verify hooks are installed: `pre-commit run --all-files`
- Check hook configurations
- Update hook versions if needed
